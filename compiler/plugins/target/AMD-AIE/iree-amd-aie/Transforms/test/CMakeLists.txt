# Copyright 2023 The IREE Authors
#
# Licensed under the Apache License v2.0 with LLVM Exceptions.
# See https://llvm.org/LICENSE.txt for license information.
# SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception

iree_lit_test_suite(
  NAME
    lit
  SRCS
    "access_to_acquire_release.mlir"
    "aie_link_executables.mlir"
    "assign_channels.mlir"
    "assign_logical_objectfifo_depth.mlir"
    "assign_npu_dma_bd_ids.mlir"
    "bridge_to_air.mlir"
    "bufferize_to_allocation.mlir"
    "canonicalize_doubly_strided_op.mlir"
    "canonicalize_npu_dma_cpy_nd.mlir"
    "combine_strided_ops.mlir"
    "controlcode_loop_unrolling.mlir"
    "convert_core_forall_to_for.mlir"
    "core_loop_unroll.mlir"
    "create_aie_workgroup.mlir"
    "create_logical_objectfifo_link.mlir"
    "create_reference_to_allocation.mlir"
    "disable_vectorization.mlir"
    "distribute_cores_and_objectfifos.mlir"
    "dma_composition.mlir"
    "dma_cse.mlir"
    "dma_loop_subsumption_circular.mlir"
    "dma_loop_subsumption.mlir"
    "dma_to_circular_dma.mlir"
    "flatten_logical_objectfifo.mlir"
    "fuse_consumer_into_loop_scf_for.mlir"
    "fuse_consumer_into_loop_scf_forall.mlir"
    "fuse_fill_into_forall.mlir"
    "fuse_pack_into_loop.mlir"
    "hoist_for_affine_apply.mlir"
    "hoist_logical_obj_fifo.mlir"
    "insert_cores.mlir"
    "insert_loops_for_vectorization.mlir"
    "localize_logical_objectfifo.mlir"
    "lower_func_args.mlir"
    "lower_to_aie.mlir"
    "lower_to_ukernel.mlir"
    "lower_workgroup_count.mlir"
    "lowering_strategy.mlir"
    "lowering_strategy_conv.mlir"
    "lowering_strategy_failures.mlir"
    "lowering_strategy_objectfifo.mlir"
    "map_forall_to_cores.mlir"
    "none_access_to_temporary_buffer.mlir"
    "normalize_loop_bounds.mlir"
    "obj_fifo_bufferization.mlir"
    "pack_and_transpose_level1.mlir"
    "pack_and_transpose_level2.mlir"
    "pack_to_air.mlir"
    "pack_to_dma.mlir"
    "pack_to_dma_failures.mlir"
    "pad.mlir"
    "peel_for_loop.mlir"
    "propagate_data_layout.mlir"
    "remove_memory_space.mlir"
    "sink_into_core.mlir"
    "split_logicalobjfifos_for_connection_reuse.mlir"
    "temporary_alloc_bufferization.mlir"
    "tile_and_fuse_using_scf_for.mlir"
    "tile_and_fuse_matmul_using_scf_forall.mlir"
    "tile_and_fuse_convolution_using_scf_forall.mlir"
    "tile_copy_using_scf_for.mlir"
    "vectorization.mlir"
  TOOLS
    ${IREE_LLD_TARGET}
    FileCheck
    iree-opt
  LABELS
    "hostonly"
)


iree_cc_test(
  NAME
    AMDAIEDmaUtilsTest
  SRCS
    "AMDAIEDmaUtilsTest.cpp"
  DEPS
    gtest
    iree::target::amd-aie::Transforms
)


iree_cc_test(
  NAME
    AMDAIEUtilsCppTest
  SRCS
    "AMDAIEUtilsTest.cpp"
  DEPS
    gtest
    iree::target::amd-aie::Transforms
    iree::compiler::Dialect::HAL::IR
    iree::compiler::Dialect::HAL::IR::HALDialect
)
